---
layout: single
title: "3D Graph Contrastive Learning for Molecular Property Prediction"
---
"3D Graph Contrastive Learning for Molecular Property Prediction"
"Small-scale 3D Graph Contrastive Learning for Molecular Property Prediction"
# Abstract


<br />
<br />


<br />

# Experiments
- 3 scaffold + 3 times
- dropout 0.0, 0.3만 비교할 것

## Freesolv
- Freesolv는  pretrain epoch, dropout 찜찜함..
- finetune의 dropout과 pretrain epoch 줄이는 것이 비슷한 효과를 나타내는 것으로 추정
### **Pretraining setup**
#### 1. pretrain의 MMFF 비교 - 1,4 > 3,4 / 1,2  **RAMDOM** **비교중**
#### 2. pretrain의 gamma 비교 - 0.99 > 0.97 > 0.95 (고정)
#### 3. pretrain의 MLP 비교 -  ReLU > SSP (고정)
#### 4. pretrain의 epoch 비교 -  39(1, 2) > 420, 432 **비교중**
#### 5. pretrain의 dropout 비교 - 0.2 > 0.0 **비교중**
MMFF, dropout, epoch 비교!!!  

### **Fine-tuning setup**
#### 1. finetune의 gamma 비교 - 0.99 > 0.97 > 0.95
#### 2. finetune의 weight decay 비교 - 1e-4 > 0 **비교중**
#### 3. finetune의 MLP 비교 -  SSP > ReLU
<br />

## ESOL
- ESOL은 pretrain이 best 일때 성능이 좋아보임
### **Pretraining setup**
#### 1. pretrain의 MMFF 비교 - 1,2 > 3,4 > 1,4 (고정)
#### 2. pretrain의 gamma 비교 - 0.95 > 0.97 > 0.99 (고정)
#### 3. pretrain의 MLP 비교 -  ReLU > SSP (고정)
#### 4. pretrain의 epoch 비교 -  375 > 30 > 10 (고정)
#### 5. pretrain의 dropout 비교 - 0.0 > 0.2 (고정)

### **Fine-tuning setup**
#### 1. finetune의 gamma 비교 - 0.95 > 0.97 > 0.99 (고정)
#### 2. finetune의 weight decay 비교 - 1e-6 > 5e-6 / 1e-4 = 5e-5 / 1e-3 > 1e-5
비교중 - 1e-6 vs 1e-4 vs 5e-5 vs 5e-4
#### 3. finetune의 MLP 비교 - SSP > ReLU (고정)


<br />


# Results
- supervised 보다 pretrain 했을 경우 성능이 향상되는 정도가 가장 뛰어남. 우리의 방법이 3D 분자 표현을 학습하는데에 적합한 방법임.
- dataset으로 small molecule (<20) + low level (Regression) 4가지 dataset 사용
<br />

|Dataset  |ESOL   |Freesolv| QM7   | QM8    |Pretrain| Params | Improvement |
|---      |---    |---     | ---   | ---    | ---    | ---    |--- |
|CoMPT    | 0.798 | 1.855  | ---   | ---    | ---    | ---    |--- |
|No GROVER| 0.911 | 1.987  | 89.408| 0.017  | ---    | ---    |--- |
|GROVER   | 0.831 | 1.544  | 72.5  |**0.0125**| 11 MM|100 MM| 15.55 / 19.15  |
|No MPG   | 0.896 | 1.967  | ---   | ---    | ---    | ---    |--- |
|MPG      |0.741|**1.269**|--- | ---    | 11 MM  | 50 MM  | 26.75 / -- |
|No GEM   | 0.832 | 1.857  | 59.0  | 0.0173 | ---    | ---    |--- |
|GEM      | 0.798 | 1.877  | 58.9  | 0.0171 | 20 MM  | ?? MM  | 14.1 / -0.1 / 0.02 / 1.2  |
|No 3DGCL | 0.921 | 1.704  | 51.62  | 0.0175 | ---    | ---    | --- |
|3DGCL    |**0.721**| 1.53  |**43.32**| 0.0126| 1,128  |1MM     | **31 / 26.15** |

<br />

![pretrain](../images/2022-01-29-3DGCL/pretrain.png)

<br />

![params](../images/2022-01-29-3DGCL/params.png)

<br />

|Dataset  |ESOL     |Freesolv | QM7     | QM8    |  Pretrain  |
|---      |---      |---      | ---     | ---    |     ---    |
|GROVER   | 0.831   | 1.544   | 72.5    | 0.0125 | 11 millions|
|MPG      |0.741|**1.269**|---      | ---    | 11 millions|
|GEM      |0.798    |1.877    |58.9     | 0.0171 | 20 millions|
|3DGCL    | **0.721**   | 1.608   | **43.4**| 0.0126 | 1,128      |

<br />


|Dataset  |ESOL   |Freesolv| QM7   | QM8    |  
|---      |---    |---     | ---   | ---    |
|epoch    |300/200|300/200 |300/100| ESOL   |
|es       |---    |---     |---    | 30     |
|pretrain | ESOL  | ESOL   | ESOL  | ESOL   |
|parameter|1280257| ESOL   | 368769| 368769 |
|cutoff   | 5.0   | 8.0    | 8.0   | 8.0    |
|layers   | 2     | 2      | 2     | 2      | 
|filters  | 128   | 512    | 256   | 256    |
|gaussians| 50    | 50     | 100   | 100    |
|z_dim    | 512   | 256    | 128   | 128    |
|optim    | Expo  | Expo   | Expo  | Expo   | 
|gamma    | 0.95  | 0.95   | 0.95   | ---    | 
|decay    | 0.001 | 0      | 0.0001 | ---    |
|dropout  | 0.3   | 0.0    | 0.0   | ---    |
|Super    | 0.921 | 1.72   | ---  | --- | 
|Conformer|**0.721**| 1.53  | **41.33**  | --- | 
|DropN    | 0.784  | 1.703    | 44.57  | --- | 
|MaskN    | 0.773  | 2.2   | 48.75  | --- | 
|Noise    | 0.753 | 1.793    | 46.32 | --- | 
|SOTA     | Yes   | No    | Yes   | No     | 
|Decrease | 26.4% | 35.6%  | 14.6% | 28%    | 

<br />

## ESOL
|Augmentation|ETKDG|Noise|Atom Dropping|Attribute Masking|
|---|---|---|---|---|
|ETKDG             | 0.867 | 0.867 | 0.867 | 0.867 |
|Noise             | 0.867 | 0.867 | 0.867 | 0.867 |
|Atom Dropping     | 0.867 | 0.867 | 0.867 | 0.867 |
|Attribute Masking | 0.867 | 0.867 | 0.867 | 0.867 |

<br />

## Pretrain Detail
|Dataset  |ESOL   |
|---      |---    |
|Epoch   | 50, 300 |
|cutoff   | 5.0, 8.0 |
|layers   | 2
|filters  | 128, 256, 512 |
|gaussians| 50, 100    | 
|z_dim    | 128, 256, 512   |
|optim    | Expo  |
|lr       | 1e-3  |
|gamma    | 0.95, 0.99  |
|decay    | 0.001 |
|dropout  | 0.0   |
|Conformer|---    |
|DropN    | ---   |
|MaskN    | ---   |
|Noise    | ---   |

<br />

|Dataset  |E1-CC2 |E2-CC2 |f1-CC2 | f2-CC2|E1-PBE0|E2-PBE0|f1-PBE0|f2-PBE0|E1-CAM |E2-CAM |f1-CAM |f2-CAM |
|---      |---    |---    | ---   | ---   | ---   | ---   |---    | ---   | ---   | ---   | ---   |---   |
|pretrain | ESOL  | ESOL  | ESOL  | ESOL  | ESOL  |ESOL   | ESOL  | ESOL  | ESOL  |ESOL   | ESOL  |ESOL   | 
|cutoff   | 8.0   | 8.0   | 8.0   | 8.0   | 8.0   | 8.0   | 8.0   | 8.0   | 8.0   | 8.0   | 8.0   | 8.0   | 
|layers   | 2     | 2     | 2     | 2     | 2     | 2     | 2     | 2     | 2     | 2     | 2     | 2     | 
|filters  | 256   | 256   | 512   | 512   | 512   | 512   | 512   | 512   | 512   | 512   | 512   | 512   |
|gaussians| 100   | 100   | 100   | 100   | 100   | 100   | 100   | 100   | 100   | 100   | 100   | 100   |
|z_dim    | 128   | 128   | 128   | 128   | 128   | 128   | 128   | 128   | 128   | 128   | 128   | 128   | 
|gamma    | 0.0   | 0.0   | 0.0   | 0.0   | 0.0   | 0.0   | 0.1   | 0.2   | 0.0   | 0.0   | 0.0   | 0.2   |
|dropout  | 0.0   | 0.1   | 0.0   | 0.1   | 0.0   | 0.0   | 0.1   | 0.2   | 0.0   | 0.0   | 0.0   | 0.2   |
|optim    | Expo  | Expo  | Expo  | Expo  | Expo  | Expo  | Expo  | Expo  | Expo   |Expo  | Expo  |Expo   | 
|Super    |0.00774|0.00895|0.02341|0.3931|0.00787|0.00853|0.02019|0.03112|0.00738 |0.00793|0.0000|0.0000|
|Conformer|0.00638|0.00784|0.0149 |0.3506 |0.00649|0.00698|0.01356|0.2661|0.00602 |0.00684|0.01644|0.0000|
|dropN    |0.00606|0.00783|0.01903|0.3845|0.00655|0.00733|0.01795|0.2665|0.00602 |0.00666|0.015  |0.0000|
|maskN    |0.0000 |0.0000 |0.0000|0.0000|0.0000|0.0000|0.0000|0.0000|0.0000 |0.0000|0.0000|0.0000|
|Noise    |0.0000 |0.0000 |0.0000|0.0000|0.0000|0.0000|0.0000|0.0000|0.0000 |0.0000|0.0000|0.0000|
<br />

# Self-Supervised Learning for Molecular Property Prediction
## 1. Introduction
### 1.1. Graph-based molecular representation.
### 1.2. Pre-training methods for GNNs.

## 2. Related Work
### 2.1. Graph Neural Networks
### 2.2. Molecular Property Prediction
### 2.3. Self-supervised learning

## 3. Method
### 3.1. Intuition
### 3.2. Pretext tasks
#### 3.2.1. Atom level
#### 3.2.2. Fragment level
#### 3.2.3. Molecule level

## 4. Experiments
### 4.1. Datasets
#### 4.1.1. Pre-training dataset
#### 4.1.2. Target dataset
### 4.2. Model architectures
### 4.3. Training and evaluation
### 4.4. Results
### 4.5. Additional experiments
#### 4.5.1. Ablation study
#### 4.5.2. Testing different input features

## 5. Conclusion

<br />

# Geometry-enhanced molecular representation learning for property prediction
## 1. Preliminaries
### 1.1. Graph-based molecular representation.
### 1.2. Pre-training methods for GNNs.

## 2. The GEM framework
### 2.1.  GeoGNN
### 2.2. Geometry-level self-supervised learning task
#### 2.2.1. Local spatial structures
#### 2.2.2. Global spatial structures

## 3. Experiments
### 3.1. Pre-training settings
#### 3.1.1. Datasets
#### 3.1.2. Self-supervised learning task settings

### 3.2. Molecular property prediction settings
#### 3.2.1. Datasets and splitting method
#### 3.2.2. GNN architecture
#### 3.2.3. Evaluation metrics
#### 3.2.4. Baselines

### 3.3. Experimental Results
#### 3.3.1. Contribution of GeoGNN
#### 3.3.2. Contribution of geometry-level tasks
#### 3.3.3. Pre-trained representations visualization
#### 3.3.4. Impact of the quality of geometry
#### 3.3.5. Contributions of atom-bond and bond-angle graphs

## 4. Related work

## 5. Conclusion

## 6. Methods